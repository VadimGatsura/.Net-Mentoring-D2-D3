# Задания к модулю Windows Services

### Задание 1

Разработать службу «склейки», результатов работы потокового сканера в единый PDF (или XPS) файл.
Служба должна уметь следующее:

* Cледить за одной или несколькими папками на диске или в сети
* При появлении в папках изображений, подходящих именами под шаблон <префикс>_<номер>.<png|jpeg|…> собирать последовательность страниц и сохранять их как единый документ в отдельную папку.
* При запуске просматривать папки для мониторинга и при наличии там подходящих файлов также объединять их в документ.

В качестве признака «конца документа» предлагается использовать следующие:
* «Перескок» нумерации документов (т.е. img_001.jpeg, img_002.jpeg, img_004.jpeg – это два документа из 2 и 1 страниц)
* Истек таймаут появления следующей страницы

### Задание 2

Проверьте, что ваша служба корректно обрабатывает следующие ситуации:
* Исходный файл, который вам нужно обработать занят другим процессом (обычно делают несколько попыток открыть и только после их истечения – ошибка)
* Пришла команда остановки службы во время длительной операции (например, собирания многостраничного файла из множества страниц)
* Одна или несколько страниц для многостраничного файла оказались «битыми» (например, неверный формат). Возможная реакция – перемещение всей последовательности в отдельную папку «битых», для дальнейшей ручной корректировки


